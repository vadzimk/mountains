<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="/build/tailwind.css" rel="stylesheet">
    <title>Document</title>
    <script>
      // https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API

      window.addEventListener("load", (event) => {
        const headerBar = document.querySelector("header");
        const headerLogoType = document.querySelector("#logotype");
        const targetSection = document.querySelector("#home");

        if ("IntersectionObserver" in window &&
          "IntersectionObserverEntry" in window &&
          "intersectionRatio" in window.IntersectionObserverEntry.prototype) {
          const handleIntersect = (entries) => {
            // console.log(entries)
            // console.log(entries[0].boundingClientRect.y)
            if (entries[0].boundingClientRect.y >= -300) {
              headerBar.classList.add("text-white")
              headerBar.classList.remove("bg-white/50")
              headerLogoType.classList.add("hidden")
            } else if (entries[0].boundingClientRect.y < -300 && entries[0].boundingClientRect.y > -700) {
              headerBar.classList.remove("text-white")
              headerBar.classList.remove("bg-white/100")
              headerBar.classList.add("bg-white/50")
              headerLogoType.classList.remove("hidden")
              headerLogoType.classList.add("opacity-50")
            } else { // no intersection
              headerBar.classList.remove("bg-white/50")
              headerBar.classList.add("bg-white/100")
              headerLogoType.classList.add("opacity-100")
              headerLogoType.classList.remove("opacity-50")
            }
          }
          let options = {
            root: null,
            rootMargin: "0px",
            threshold: Array(11).fill().map((_, i) => i / 10),
          }
          const observer = new IntersectionObserver(handleIntersect, options);
          observer.observe(targetSection);
        }


        // slideshow
        const NUM_VISIBLE_SLIDES = 4
        const GAP_WIDTH = 10
        const thumbnailsContainer = document.getElementById("thumbnails-container")
        const thumbnails = document.getElementById("thumbnails")
        thumbnails.classList.add(`gap-[${GAP_WIDTH}px]`)
        const slides = document.getElementsByClassName("thumbnail")
        const widthAvailable = slides[0].clientWidth * NUM_VISIBLE_SLIDES + GAP_WIDTH * (NUM_VISIBLE_SLIDES-1);
        thumbnails.style.width = `${widthAvailable}px`
        let widthTotal = 0
        for (let slide of slides) {
          let width = slide.clientWidth
          // console.log(width)
          widthTotal += width
        }
        widthTotal = widthTotal + (slides.length-1)*GAP_WIDTH // except the last item
        // console.log(widthTotal, widthAvailable) //TODO debug
        const numberOfWindows = Math.round(widthTotal / widthAvailable)
        const circleNav = document.getElementById("circle-nav")
        console.log("numberOfWindows", numberOfWindows) //TODO debug
        let currentDistanceFromParent = 0

        const circleCallback = (windowNumber) => {
          // reset circles active to inactive
          const circles = document.getElementsByClassName("circle")
          let previousActive = null
          for (let i = 0; i < circles.length; i++) {
            if (circles[i].classList.contains("active")) {
              previousActive = i
              circles[i].classList.remove("active")
              circles[i].classList.add("inactive")
            }
            if (i === windowNumber) {
              circles[i].classList.remove("inactive")
              circles[i].classList.add("active")
            }
          }
          // console.log("windowNumber", windowNumber)
          const slide = slides[windowNumber * NUM_VISIBLE_SLIDES]
          const parentLeft = thumbnailsContainer.getBoundingClientRect().left
          const childLeft = slide.getBoundingClientRect().left
          const childDistance = childLeft - parentLeft
          // console.log("childDistance+currentDistanceFromParent", currentDistanceFromParent, childDistance)
          const distance = currentDistanceFromParent + childDistance
          // console.log("translateX: distance", distance)
          thumbnails.style.transform = `translateX(${-1*distance}px)`
          currentDistanceFromParent = distance
        }

        // add event listeners and active/inactive class
        for (let i = 0; i < numberOfWindows; i++) {
          const circle = document.createElement('div')
          circle.classList.add("circle")
          if (i === 0) {
            circle.classList.add("active")
          } else {
            circle.classList.add(("inactive"))
          }
          circle.addEventListener('click', () => circleCallback(i))
          circleNav.appendChild(circle)
        }


      }, false);

    </script>
</head>
<body class="relative">
<header class="fixed top-0 left-0 right-0 z-20 py-3.5 transition ">
    <div class="w-[960px] m-auto flex items-center justify-between ">
        <a href="/" class="pl-5 inline-block flex gap-2.5">
            <img src="/assets/Logo.png" alt="Los Angeles Mountains" class=""/>
            <img id="logotype" src="/assets/losangeles_mountains.png" alt="Home"/>
        </a>
        <nav class="flex justify-between">
            <ul class="flex gap-12 list-none">
                <li>
                    <a href="#history" class="nav-link">01. HISTORY</a>
                </li>
                <li>
                    <a href="#team" class="nav-link">02. TEAM</a>
                </li>
            </ul>
        </nav>
    </div>
</header>
<main class="">
    <section id="home"
             class="bg-[url('/assets/Image1.png')] bg-no-repeat bg-cover h-[906px] relative top-0 left-0 right-0 w-full">
    </section>
    <section id="history"
             class="bg-[url('/assets/Peak.png')] bg-no-repeat bg-cover h-[906px] flex flex-col justify-between">
        <article class="section-contents">
            <div class="relative">
                <div class="h2-prefix-txt inline-block">01.</div>
                <h2 class="uppercase inline-block relative bottom-[2.3rem] -left-[2.3rem]">
                    History
                </h2>
            </div>
            <div class="px-3">
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin in ante viverra, rutrum erat rutrum,
                    consectetur mi. Proin at maximus est. Nullam purus ex, iaculis sed erat sed, blandit tincidunt quam.
                    Cras scelerisque id quam sed dignissim Pellentesque urna nunc, gravida quis hendrerit ac, tristique
                    ut quam. Vivamus suscipit dignissim tortor nec congue. </p>
            </div>
        </article>
        <!-- Carousel -->
        <div class="bg-[#414f6b]/80 h-[12rem] flex flex-col justify-center gap-3">
            <!-- Thumbnails -->
            <div id="thumbnails-container" class="mx-auto overflow-hidden relative">
                <div id="thumbnails" class="flex relative ease-in duration-[300ms]">
                    <img src="/assets/group10.png" class="thumbnail"/>
                    <img src="/assets/group8.png" class="thumbnail"/>
                    <img src="/assets/group10.png" class="thumbnail"/>
                    <img src="/assets/group8.png" class="thumbnail"/>

                    <img src="/assets/group10.png" class="thumbnail"/>
                    <img src="/assets/group8.png" class="thumbnail"/>
                    <img src="/assets/group10.png" class="thumbnail"/>
                    <img src="/assets/group8.png" class="thumbnail"/>

                    <img src="/assets/group10.png" class="thumbnail"/>
                    <img src="/assets/group8.png" class="thumbnail"/>
                    <img src="/assets/group10.png" class="thumbnail"/>
                    <img src="/assets/group8.png" class="thumbnail"/>

                </div>
            </div>
            <!-- Circle nav -->
            <div id="circle-nav" class="flex gap-2.5 justify-center">
            </div>
        </div>
    </section>
    <section id="team" class="">
        <div>02.</div>
        <h2 class="uppercase">
            Climb</h2>
    </section>
</main>
</body>
</html>